---
title: "Datos"
author:
- Lourdes Sofía Elizondo Guajardo
- Daniela Diaz Delgado
- Bernardo Ortega Chávez
- Gabriel González Bataller
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
    toc_depth: 4
    number_sections: yes
  html_document:
    toc: yes
    toc_depth: '4'
    df_print: paged
subtitle:
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("gmodels")
library("ggplot2")
library("pROC")
library("rpart")
library("rattle")
library("rpart.plot")
library("tinytex")
library("kableExtra")
library("ROSE")
library("tibble")
library("bitops")
library("tidyquant")
library("knitr")
library("plotly")
library("Sim.DiffProc")
library("readxl")
library("usethis")
```

# Population data: Infonavit's portfolio today

## Data Analysis

```{r}
# Número de Créditos Formalizados
NCTotal<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 1)
NCTipoDeProducto<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 2)
NCLinea<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 3)
NCClasifDeVivienda<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 4)
NCIngreso<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 5)
NCEdad<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 6)
NCEstado<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeCreditosFormalizados.xlsx", sheet = 7)

# Importe de Cheque
ITotal<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 1)
ITipoDeProducto<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 2)
ILinea<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 3)
IClasifDeVivienda<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 4)
IIngreso<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 5)
IEdad<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 6)
IEstado<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/ImporteDeCheque.xlsx", sheet = 7)

# Monto de Crédito Infonavit
MCTotal<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 1)
MCTipoDeProducto<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 2)
MCLinea<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 3)
MCClasifDeVivienda<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 4)
MCIngreso<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 5)
MCEdad<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 6)
MCEstado<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeCreditoInfonavit.xlsx", sheet = 7)

# Número de Subsidios
NSTotal<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 1)
NSTipoDeProducto<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 2)
NSLinea<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 3)
NSClasifDeVivienda<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 4)
NSIngreso<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 5)
NSEdad<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 6)
NSEstado<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/NumeroDeSubsidios.xlsx", sheet = 7)

# Monto de Subsidios
MSTotal<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 1)
MSTipoDeProducto<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 2)
MSLinea<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 3)
MSClasifDeVivienda<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 4)
MSIngreso<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 5)
MSEdad<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 6)
MSEstado<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/MontoDeSubsidios.xlsx", sheet = 7)

# Recaudación y Fiscalización de las Aportaciones Patronales
RFAP<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/RecaudacionYFiscalizacionDeAportacionesPatronales.xlsx", sheet = 1)

# Administración de la Subcuenta de Vivienda
ASV<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/AdminSubcuentaDeVivienda.xlsx", sheet = 1)
```

## Past Due Portfolio Analysis
```{r}

```

# Sample data: mortgage loans 2013-2020

## Data
```{r}
y2013<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 2)
y2014<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 3)
y2015<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 4)
y2016<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 5)
y2017<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 6)
y2018<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 7)
y2019<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 8)
y2020<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 9)
y2021<-read_excel("/Users/lulyelizondo/Desktop/DATATESIS/DATOSMUESTRA.xlsx", sheet = 10)

data1<-rbind(y2013,y2014,y2015,y2016,y2017,y2018,y2019,y2020,y2021)
nrow(data1)
```

```{r}
data2<-subset(data1, select = -c(ENTIDAD,CLAVE_MUNICIPIO,MUNICIPIO,ORGANISMO,ACCIONES))

data2$AÑO<-factor(data2$AÑO)
data2$MES_ACUMULADO<-factor(data2$MES_ACUMULADO)
data2$CLAVE_ENTIDAD<-factor(data2$CLAVE_ENTIDAD)
data2$MODALIDAD<-factor(data2$MODALIDAD)
data2$DESTINO<-factor(data2$DESTINO)
data2$TIPO<-factor(data2$TIPO)
data2$GENERO<-factor(data2$GENERO)
data2$EDAD<-factor(data2$EDAD)
data2$INGRESO<-factor(data2$INGRESO)
data2$VALOR_VIVIENDA<-factor(data2$VALOR_VIVIENDA)
data2$MONTO<-as.numeric(data2$MONTO)
data2$CLAVE<-factor(data2$CLAVE)

summary(data2)
str(data2)
head(data2)
tail(data2)
```

## Sample Data Analysis
```{r}
```

## Adjust Sample to Match Population's Characteristics 
```{r}
```

## Asign Variable Status
```{r}
```

# Credit Risk Model

## Logistic Regression
```{r}
```

## Evaluation
```{r}
```

## Regional Analysis
```{r}
```

# Building a Cross-Subsidy Scheme

## Asigning an Interest Rate
```{r}
```

# Comparative Statics & Tests
```{r}
```